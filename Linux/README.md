## 新しく作ったLet's Noteでの構成

- ファイルエクスプローラ
  - Thunar
- ターミナルエミュレータ
  - Alacritty
- ブラウザ
  - Chromium
- 画面輝度
  - xbacklight
- マルチスクリーン
  - arandr
    - xrandrというxorgのプロジェクトのGUIクライアント
- インストールしたパッケージ
  - いろいろ試して必要最低限のものだけを`installed-pacakges`に乗せておいた

## Let's note特有の問題
- スピーカーから音が出ない
  - ALSAの設定とPulseAudioの設定が必要
  - ALSAでは，RealTekのサウンドカードをデフォルトに設定する必要がある
    - asoundconfというアプリケーションを使って設定を変更する
    - https://x.momo86.net/?p=23
  - PulseAudioでは，アナログスピーカーの音量調整の方法の設定を変更する
    - https://gtrt7.com/blog/linux/ubuntu1710-on-letsnote#i-4
- ~~なんか左Ctrlの調子が悪い~~
  - ~~押しっぱなしになるw~~
  - Let's Noteのせいじゃないかも？（よくわからん）
  - Mozcの設定間違ってただけだった

## キーボードの問題
現状自分の環境では英語キーボードと日本語キーボードを併用するという凄まじいことをやっている．
この環境で快適に作業するためにはいろいろな工夫が必要だった

- まず，CapsLockをCtrlにしたり，Emacsのキーバインドが使用できるようにするためにXKBの設定をいじりまくった
  - https://www.x.org/releases/X11R7.6/doc/xorg-docs/input/XKB-Config.html
  - このサイトに設定方法が記載されている
  - autokeysとか言うツールも使った
- 20時間ほどいじくり回して真理にたどり着いた
  - そもそもLinuxはMacじゃないのでEmacsのキーバインドは必要ない（むずすぎ）
  - まず，XKBはコンビネーションで他のキーコードを送るようにはできてない．XKBはドキュメントを読む限り，いろいろなメーカー製パソコンの配列に対応してキーボードを使用できるようにする，くらいのものだった．
    - XKBでコンビネーションを贈ろうとすると例えば`<C-h>`を`<BS>`にしたい場合，`<C-BS>`が送られてしまうという問題があった．この問題はArch Wikiによると回避できそうではあるが，かなり難しそう．今度もう一回XKBのマニュアルを読んで挑戦することにしたい
  - 次に，autokeysはゴミ．Alacrittyではキーコードを送らないようにしたいのに，なぜかできなかった
- 最終的な構成
  - `setxkbmap`でキーボードごとにキーレイアウト（usとかjpとか）を設定
    - その際に，`options`で`ctrl:nocaps`を指定．
    - `ctrl:nocaps`は`/usr/share/X11/xkb/symbols/ctrl`の一番上に書いてある．デフォルトでは`replace key ~`とかいてあるが，`replace`を削除するとcaps lockを完全に殺すことができるのでそうした
    - 実際に設定してるのは`~/.xmonad/set_keyboard.sh`．`xinput`を使用してキーボードが刺さっているかどうかをみて刺さってたら設定，ってことをやってる．キーボードを指したらXmonadの再起動が必要だが，モニタを指したら再起動する運用なのでもんだいない
  - Vimの中ではVimの設定に入ってる`xvkbd`でnormalモード・insertモードの変換時の入力モード切り替え機能により，入力モード切り替えの煩わしさを解消．
  - 英数・かなを使用せずにIMEをトグルする方法として`<C-,>`，`<C-.>`という方法を編み出した
    - `<C-,>`でIMEがオフになり，`<C-.>`でIMEがオンになるという仕様．
    - これならUSキーボードでも快適に使えるはず

## IBusの設定
- xvkbdが何故かmuhenkanを送ってくれないので，`Ctrl-Shift-Muhenkan`を使用することで対応．
  - なので，IBusに設定する必要がある
- あと，`Ctrl-,`で英数，`Ctrl-.`でかなを送るようにした
  - この設定はVimで使用すると必要ないときに
